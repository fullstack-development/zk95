/* eslint-disable @typescript-eslint/ban-ts-comment */
import { StrictMode } from 'react';
import * as ReactDOM from 'react-dom/client';
import { ModalProvider } from 'styled-react-modal';
import { styleReset } from 'react95';
import { createGlobalStyle, ThemeProvider } from 'styled-components';

import { ModalBackground } from '@mixer/components';
import { mkCustomizeModel } from '@mixer/customizer';

import { mkApp } from './app/app';

// @ts-ignore
import ms_sans_serif from 'react95/dist/fonts/ms_sans_serif.woff2';
// @ts-ignore
import ms_sans_serif_bold from 'react95/dist/fonts/ms_sans_serif_bold.woff2';
import { useProperties } from '@frp-ts/react';
import { injectable } from '@mixer/injectable';
import { useRunEff } from '@mixer/utils';

const GlobalStyles = createGlobalStyle`
  ${styleReset}
  @font-face {
    font-family: 'ms_sans_serif';
    src: url('${ms_sans_serif}') format('woff2');
    font-weight: 400;
    font-style: normal
  }
  @font-face {
    font-family: 'ms_sans_serif';
    src: url('${ms_sans_serif_bold}') format('woff2');
    font-weight: bold;
    font-style: normal
  }
  body, input, select, textarea {
    font-family: 'ms_sans_serif';
  }

  html, body, #root {
    font-family: 'ms_sans_serif';
    height: 100vh;
  }

  * {
    box-sizing: border-box;
  }
`;

const root = ReactDOM.createRoot(
  document.getElementById('root') as HTMLElement
);

const mkRoot = injectable(
  mkCustomizeModel,
  mkApp,
  (customizeModel, appEff) => () => {
    const [themeKey] = useProperties(customizeModel.selectedTheme$);
    const App = useRunEff(appEff);

    return (
      <StrictMode>
        <GlobalStyles />
        <ThemeProvider theme={customizeModel.themes[themeKey]}>
          <ModalProvider backgroundComponent={ModalBackground}>
            <App />
          </ModalProvider>
        </ThemeProvider>
      </StrictMode>
    );
  }
);

const Root = mkRoot({
  onchainConfig: {
    100: {
      script: {
        type: 'PlutusV2',
        cbor: '5906c15906be01000032323232323232323232323232323232323232323232323222232323232323232323232323232533301f3370e9001001099999119980f111299981280089128008a9998121801181400089911180100198140008998018011813800980d0008011bac302300430230012323232323232323232323232533302c3370e90000010a99981619baf3030302701d3030302730233030302f00b1533302c3370e66e04c07c018c07cdd59818181798138061bad3030302f005149854cc0c5241274e6f6d696e616c20616d6f756e742073686f756c64206265207061696420746f20736372697074001615330314911c4e756c6c69666965722068617368206c697374206d6f646966696564001615330314910f4e6f7420696d706c656d656e7465640016303200230320013754032664464a66605666e1ccc88cccc08800920002333302300248001d69bab001004375c605e0026eb8c0bcc0b80052002149854cc0c12401284f75747075742073686f756c6420636f6e7461696e206f6e652070726f746f636f6c20746f6b656e00163025002302c00100230220193756605400aa66604a66e1d20000021323232324994ccc0a4004526153302d02a16302a00333022232002375a0026eb0004c0a400454cc0a80ac58c0ac008c0ac004dd5180c981318128009812180e1929998118008a99813a49104e6f206f75747075747320666f756e640016132533302400113027002153302849011a4d6f7265207468616e206f6e65206f757470757420666f756e6400163025001332233230212253330270011024132533302730040011330260013003302a00213003302a002302a001301c3027301e0010023758604a6048604800c0026048604660360022a6604892014c5061747465726e206d61746368206661696c75726520696e207175616c69666965642027646f2720626c6f636b206174207372632f4d697865722f5363726970742e68733a34383a332d3136001615330244914c5061747465726e206d61746368206661696c75726520696e207175616c69666965642027646f2720626c6f636b206174207372632f4d697865722f5363726970742e68733a34363a332d313300163025002302500137546040603e004602c603e002602a012a66603266e1d20000021323232324994ccc074004526153302101e16301e003375c002603a0022a66603266e1d20020021324994ccc068004526153301e01b16153301e01f16301f002301f001375400ca66602a66e1d20000021323232324994ccc064004526153301d01a16301a00333012232002375a0026eb0004c06400454cc06806c58c06c008c06c004dd50019919191900da99980899b87480000084c8c8c8c8c8c8c8c8c8c926533301b001149854cc07c07058c07000cdd6800980d800980c803299980a99b87480000084c8c8c94ccc0614cc8cc06400452899b87001480004cdc3800a40702646464a66603666e24dc6800a40802646493299980e8008a4c2a6604203c2c603c0062a660409201327074727946726f6d28546f6b656e4e616d65293a206d757374206265206174206d6f7374203332204279746573206c6f6e670016375c002603a00260360082a6603a9201387074727946726f6d2843757272656e637953796d626f6c293a206d757374206265203238206279746573206c6f6e67206f7220656d7074790016371a0026eb8004c06400454cc06806c58c06c008c06c004dd5000980a8008a9980b00b8b180b801180b8009baa0172533300f0011480004ccc038cdd7980b18090009ba9002375a602a60246eacc054c048005200048810023002375200244446601644a666022002200a2a66602066ebcc060c0500040184c010c05cc0500044c008c04c0040048c8c8c94ccc034cdc3a4008004260220022a6602400a2c602600460260026ea80052401254f75747075742073686f756c6420636f6e7461696e20696e6c696e61626c6520646174756d002233003002300d3004001223375e6e9cc00c008dd39801800918069baa0012300222533300800110051330063003300b0013002300a0012323002233002002001230022330020020014bd702ba05734aae7d2401317074727946726f6d2850446174615265636f72645b5d293a206c697374206973206c6f6e676572207468616e207a65726f005744ae855ce2493f7265616368656420656e64206f662073756d207768696c65207374696c6c206e6f7420686176696e6720666f756e642074686520636f6e7374727563746f72005573caae75300140d8799fd8799f581cbbd65a4af3dd5bb07b11cfb66418cdffc6bd26817559e0c5a80f405d544d697865722050726f746f636f6c20546f6b656eff1a05f5e100ff0001',
      },
      tokenUnit:
        'bbd65a4af3dd5bb07b11cfb66418cdffc6bd26817559e0c5a80f405d4d697865722050726f746f636f6c20546f6b656e',
      addressWithScriptRef:
        'addr_test1wzaavkj270w4hvrmz88mveqcehlud0fxs964ncx94q85qhgrec9x5',
    },
  },
});

root.render(<Root />);
